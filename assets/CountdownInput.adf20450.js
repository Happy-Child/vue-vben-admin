import{h as t,j as n,ad as e,d as a,B as o,a as s,ae as u,r,o as l,f as i,p as c,q as d,t as f,m as p,af as m,u as C,g as v}from"./index.98f65128.js";import{I as S}from"./index.f53810ec.js";import{u as b}from"./useFormItem.7b2a5d72.js";var x=a({name:"CountButton",components:{Button:o},props:{count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},setup(a){const o=t(!1),{currentCount:r,isStart:l,start:i}=function(a){const o=t(a),s=t(!1);let u;function r(){u&&window.clearInterval(u)}function l(){s.value=!1,u=null,r()}function i(){n(s)||u||(s.value=!0,u=setInterval((()=>{1===n(o)?(l(),o.value=a):o.value-=1}),1e3))}function c(){o.value=a,l()}return e((()=>{c()})),{start:i,reset:c,restart:function(){c(),i()},clear:r,stop:l,currentCount:o,isStart:s}}(a.count),{t:c}=s();return{handleStart:async function(){const{beforeStartFunc:t}=a;if(t&&u(t)){o.value=!0;try{await t()&&i()}finally{o.value=!1}}else i()},isStart:l,currentCount:r,loading:o,t:c}}});x.render=function(t,n,e,a,o,s){const u=r("Button");return l(),i(u,p(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:c((()=>[d(f(t.isStart?t.t("component.countdown.sendText",[t.currentCount]):t.t("component.countdown.normalText")),1)])),_:1},16,["disabled","onClick","loading"])};var g=a({name:"CountDownInput",components:{[S.name]:S,CountButton:x},props:{value:m.string,size:m.oneOf(["default","large","small"]),count:m.number.def(60),sendCodeApi:{type:Function,default:null}},setup(t){const{prefixCls:n}=C("countdown-input"),[e]=b(t);return{prefixCls:n,state:e}}});g.render=function(t,n,e,a,o,s){const u=r("CountButton"),d=r("AInput");return l(),i(d,p(t.$attrs,{class:t.prefixCls,size:t.size}),{addonAfter:c((()=>[v(u,{size:t.size,count:t.count,beforeStartFunc:t.sendCodeApi},null,8,["size","count","beforeStartFunc"])])),_:1},16,["class","size"])};export{g as _};
